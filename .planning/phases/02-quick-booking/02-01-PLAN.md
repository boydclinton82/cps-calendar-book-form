---
phase: 02-quick-booking
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/App.jsx
  - src/components/Header.jsx
  - src/components/Header.css
autonomous: true

must_haves:
  truths:
    - "Book Now button visible when current hour is available"
    - "Book Now button hidden when current hour is booked"
    - "Book Now button hidden when current hour is blocked by multi-hour booking"
    - "Clicking Book Now opens booking panel with current hour pre-selected"
    - "Booking flow works identically to clicking a slot"
  artifacts:
    - path: "src/App.jsx"
      provides: "currentHourAvailable state and handleBookNow callback"
      contains: "currentHourAvailable"
    - path: "src/components/Header.jsx"
      provides: "Book Now button with conditional rendering"
      contains: "Book Now"
    - path: "src/components/Header.css"
      provides: "Styling for Book Now button"
      contains: "book-now"
  key_links:
    - from: "src/App.jsx"
      to: "src/components/Header.jsx"
      via: "showBookNow and onBookNow props"
      pattern: "showBookNow.*currentHourAvailable"
    - from: "src/components/Header.jsx"
      to: "handleBookNow callback"
      via: "onClick handler"
      pattern: "onClick.*onBookNow"
---

<objective>
Add a "Book Now" button to the header that allows users to instantly book the current hour with one click.

Purpose: Streamlines the most common use case (check availability -> book now) from multiple clicks to a single action.

Output: Header component with conditionally visible "Book Now" button that opens the existing booking panel with the current hour pre-selected.
</objective>

<execution_context>
@/Users/clintonweekes/.claude/get-shit-done/workflows/execute-plan.md
@/Users/clintonweekes/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-quick-booking/02-RESEARCH.md
@src/App.jsx
@src/components/Header.jsx
@src/components/Header.css
@src/utils/time.js
@src/hooks/useBookings.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add current hour availability logic and Book Now handler to App.jsx</name>
  <files>src/App.jsx</files>
  <action>
Add a useMemo to compute whether the current hour is available for booking:

1. Create `currentHourAvailable` useMemo that:
   - Gets current time with `new Date()`
   - Extracts current hour with `getHours()`
   - Returns `false` if outside booking hours (before START_HOUR or >= END_HOUR)
   - Returns `false` if `isSlotPast(new Date(), currentHour)` returns true
   - Gets status via `getSlotStatus(formatDate(new Date()), formatTimeKey(currentHour), currentHour)`
   - Returns `true` only if status is 'available'
   - Dependencies: `[getSlotStatus, bookings]` - recomputes when bookings change

2. Create `handleBookNow` useCallback that:
   - Gets current time with `new Date()`
   - Extracts current hour
   - Creates slot object: `{ hour, time: formatHour(currentHour), key: formatTimeKey(currentHour), dateKey: formatDate(now) }`
   - Calls existing `handleSlotSelect(slot)`
   - Dependencies: `[handleSlotSelect]`

3. Pass new props to Header component:
   - `showBookNow={currentHourAvailable}`
   - `onBookNow={handleBookNow}`

Import `formatTimeKey` from `../utils/time` (already importing `formatDate`, `isSlotPast`, `formatHour` is new import needed).

Note: Use `new Date()` directly in the useMemo, NOT the `currentDate` state - "Book Now" always books TODAY's current hour regardless of what date the user is viewing.
  </action>
  <verify>
Run `npm run build` - no TypeScript/compilation errors. Grep for `currentHourAvailable` and `handleBookNow` in App.jsx to confirm they exist.
  </verify>
  <done>
App.jsx exports currentHourAvailable boolean and handleBookNow callback, passes them to Header as showBookNow and onBookNow props.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Book Now button to Header component with styling</name>
  <files>src/components/Header.jsx, src/components/Header.css</files>
  <action>
**Header.jsx changes:**

1. Update function signature to accept new props:
   ```jsx
   export function Header({ title, currentDate, onNavigate, onWeekToggle, isWeekView, showBookNow, onBookNow })
   ```

2. Add Book Now button in header-top div, BEFORE the week-toggle button:
   ```jsx
   <div className="header-actions">
     {showBookNow && (
       <button
         className="book-now-btn"
         onClick={onBookNow}
         aria-label="Book current hour"
       >
         <span className="mono">[B]</span> Book Now
       </button>
     )}
     <button
       className={`week-toggle ${isWeekView ? 'active' : ''}`}
       ...existing week toggle code...
     </button>
   </div>
   ```

3. Wrap both buttons in a `header-actions` div for flex layout.

**Header.css changes:**

1. Add `.header-actions` flex container:
   ```css
   .header-actions {
     display: flex;
     align-items: center;
     gap: 12px;
   }
   ```

2. Add `.book-now-btn` styling matching the week-toggle button style but with a more prominent appearance:
   - Same base style as week-toggle (border, padding, border-radius)
   - Use a slightly different color or stronger glow to indicate primary action
   - Add pulse animation or brighter glow to draw attention

3. Add mobile breakpoint rule (max-width: 600px):
   - Keep book-now visible on mobile (it's more useful than week toggle)
   - Can hide week-toggle on mobile if space is tight (add `.week-toggle { display: none; }` in mobile breakpoint)

Style the button consistently with existing cyberpunk/neon aesthetic (cyan accent, glow effects).
  </action>
  <verify>
Run `npm run dev` and open in browser. When current hour is available:
1. "Book Now" button should be visible in header
2. Clicking it should open the booking panel with current hour pre-selected
3. Complete a booking to verify the slot becomes booked
4. Refresh page - "Book Now" should now be hidden (current hour is booked)
  </verify>
  <done>
Book Now button appears conditionally in header, clicking it opens booking panel for current hour, button disappears after booking the current hour.
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build` completes without errors
2. At a time like 9:15 AM, the "Book Now" button is visible
3. Click "Book Now" -> booking panel opens with 9:00 AM slot selected
4. Complete booking -> button disappears immediately (optimistic update)
5. Navigate to different date -> button still shows/hides based on TODAY's current hour availability
6. Book a 2-hour slot starting at 8:00 AM -> at 9:15 AM, "Book Now" is hidden (blocked by multi-hour booking)
7. On mobile viewport (< 600px), "Book Now" button is still visible
</verification>

<success_criteria>
- BOOK-01: User can click "Book Now" to open booking panel for current hour
- BOOK-02: "Book Now" only appears when current hour is available (not booked, not past, not blocked)
- BOOK-03: "Book Now" reuses existing booking flow (hotkey name selection, then duration)
- Button styling matches existing cyberpunk/neon aesthetic
- No regressions in existing functionality
</success_criteria>

<output>
After completion, create `.planning/phases/02-quick-booking/02-01-SUMMARY.md`
</output>
